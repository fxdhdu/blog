MySQL最重要、最与众不同的特性是它的存储引擎架构：将查询处理及其他系统任务和数据的存储/提取相分离。（处理和存储分离）可以为每张表选择合适的存储引擎。



MySQL服务器逻辑架构图：3层

连接层

服务器层

存储引擎层



## 事务

- 事务的ACID特性

- SQL标准中定义的四种事务隔离级别

  隔离级别规定了一个事务中所做的修改，哪些在事务内和事务间是可见的，哪些是不可见的。

  - read uncommitted（未提交读）：脏读（读取未提交的数据），很少使用
  - Read committed（提交读）：不可重复读（读取其他事务已提交的数据，导致同一个事务中前后两次相同查询的结果不同）
  - repeatable read（可重复读）：可能会有幻读，InnoDB通过多MVCC解决幻读问题。MySQL默认事务隔离级别
  - Serializable（可串行化）

- 死锁

  - 死锁检测
  - 死锁超时

- 事务日志

  修改表数据时只修改内存，修改行为记录到磁盘上的事务日志，事务日志采用追加方式（顺序I/O：顺序I/O是加快机械磁盘读取的方法）

- 事务型表（InnoDB）和非事务型表（MyISAM）

## 多版本并发控制（MVCC）

不同引擎不同的数据库（Oracle、PostgreSQL有不同的实现机制），避免加锁降低开销。常见实现方式有乐观并发控制、悲观并发控制。

InnoDB的实现：在每行记录后面保存行的创建时间和行的过期时间（删除时间），即系统版本号。每开始一个事务系统版本号递增，并作为事务的版本号。（类似于事务ID设计）

![image-20200803075849587](/Users/fanxudong/IdeaProjects/blog/10 分布式系统设计/asset/image-20200803075849587.png)

